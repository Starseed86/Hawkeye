<div class="wikidoc"><h2>Using FormStyleEditor</h2>
But what&#39;s the point of having a style manager when you couldn&#39;t edit the styles. So my other task was creating the <b>FormStyleEditor</b>. And here it is:<br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=CustomerBorderForm&DownloadId=807" alt="FormStyleEditor.png" title="FormStyleEditor.png" /><br /><br />The editor is designed not as separate application as one might expect, but as a component that you embedd inside of your own application. This has such advantage that when you design your style you can immediately see how it applies to your application. The editor comes packaged as a component that you drop on your form. Later you can lunch the editor (from some button, magic key combination or simply in form&#39;s Load event) by calling the <b>ShowFormEditor</b> method.<br /><br />The editor window shows contents of currently loaded style library so if you loaded one already you would see something like on the screen above, but if not you need first to add a new <b>FormStyle</b> which the <i>Add Style</i> button. Starting from left: <i>New</i> button clears the contents of current style library, <i>Open</i> loads style library from file, and <i>Save</i> of course stores your work on disk (I&#39;ve choose the .fsl extension as it simply stands for <i>Form Style Library</i>). <br /><br />As said before the library can contain more then one <b>FormStyle</b>. For example you can design different skins for the main window and for the dialogs or tool windows. Each style is identified by its <b>Name</b> that you can later reference using <b>FormStyleName</b> property on any class inheriting from <b>CustomBorderForm</b>. To select which style to edit you use the drop down list next to <i>Active Style</i> label. <i>Add Style</i> button will create additional styles, and <i>Delete Style</i> button of course removes currently selected style from the library. <br /><br />Below you have two panels: the tree on the left show hierarchy of elements of the active style and the property grid on the right lets you edit the properties of currently selected element. The hierarchy of elements starts on the <b>FormStyle</b> which has following properties:<br /><br /><table><tr><th> Property </th><th> Description </th></tr>
<tr><td> Name </td><td> Name used to identify this style in the library </td></tr>
<tr><td> ClientAreaPadding </td><td> Padding of the client rectangle relative to window bounds </td></tr>
<tr><td> IconPadding </td><td> Padding of icon rectangle relative to top-left corner of title bar </td></tr>
<tr><td> TitlePadding </td><td> Padding of the title rectangle relative to rectangle of title bar </td></tr>
<tr><td> TitleFont </td><td> Font used to paint window title </td></tr>
<tr><td> TitleColor </td><td> Color used to paint window title </td></tr>
<tr><td> TitleShadowColor </td><td> Color used to draw drop shadow behind window title </td></tr>
<tr><td> SizingBorderWidth </td><td> Offset from window border where window can be sized using a mouse horizontally or vertically </td></tr>
<tr><td> SizingCornerOffset </td><td> Offset from window corner where form can be sized in both directions </td></tr>
<tr><td> NormalState </td><td> Image used to paint background on forms non client area </td></tr>
<tr><td> CloseButton </td><td> Style for window close button </td></tr>
<tr><td> MinimizeButton </td><td> Style for window minimize button </td></tr>
<tr><td> MaximizeButton </td><td> Style for window maximize button </td></tr>
<tr><td> RestoreButton </td><td> Style for window restore button </td></tr>
<tr><td> HelpButton </td><td> Style for window help button </td></tr></table><br /><br /><br />The <b>FormButtonStyle</b> class defines appearance for the Close, Minimize, Maximize, Restore and Help buttons of the form and has following properties:<br /><br /><table><tr><th> Property </th><th> Description </th></tr>
<tr><td> Size </td><td> Size of the button rectangle </td></tr>
<tr><td> Margin </td><td> Margin around the button rectangle relative to title bar </td></tr>
<tr><td> NormalState </td><td> Image used to paint button in normal state </td></tr>
<tr><td> ActiveState </td><td> Image used to paint button in active state </td></tr>
<tr><td> HoverState </td><td> Image used to paint button in hover state </td></tr>
<tr><td> DisabledState </td><td> Image used to paint button in disabled state </td></tr></table><br /><br />Last thing that changes with this release is the way the images that are drawn on the border are assembled. Earlier the image drawn in background had to be cut into 9 pieces and specified one by one. Now you can use single image and instead you specify the stretch margins for the images. These margins specify how this image should be cut into pieces theater would be then used to fill the given screen area. Perhaps this image will better explain how it works: <br /><br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=CustomerBorderForm&DownloadId=808" alt="StretchMargins.png" title="StretchMargins.png" /><br /><br />The red lines represent the <b>StretchMagins</b> for this image. The idea here is that the four pieces cut from the corners are painted exactly the same size as in ther source image, whereas the pieces between the corners running along the horizontal and vertical borders are stretched to fill the remaining space. Also worth noting is that the <b>StretchMargins</b> for the Form don&#39;t have to be the same as the <b>ClientAreaPadding</b> (like in this example it is slightly bigger to accommodate for the round corners on top).<br /><br />The same technique is used for painting the form background and all form buttons and it is configured by the <b>SerializableImage</b> class that has following properties:<br /><br /><table><tr><th> Property </th><th> Description </th></tr>
<tr><td> Image </td><td> The actual image used to paint the corresponding element. </td></tr>
<tr><td> SizeMode </td><td> Sizing technique used to draw the image. Available values are Centered, Stretched and Tiled. </td></tr>
<tr><td> StretchMargins </td><td> Specifies the rules of dividing image into pieces for the Stretched SizeMode. </td></tr></table></div><div class="ClearBoth"></div>